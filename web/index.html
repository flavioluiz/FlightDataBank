<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AeroDataBank</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Adicionar Popper.js para tooltips -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <style>
        .sortable {
            cursor: pointer;
            user-select: none;
        }
        .sortable:hover {
            background-color: #f8f9fa;
        }
        .sortable::after {
            content: '⇅';
            margin-left: 5px;
            opacity: 0.3;
        }
        .sortable.asc::after {
            content: '↑';
            opacity: 1;
        }
        .sortable.desc::after {
            content: '↓';
            opacity: 1;
        }
        .speed-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
        }
        input:checked + .slider {
            background-color: #2196F3;
        }
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        .slider.round {
            border-radius: 34px;
        }
        .slider.round:before {
            border-radius: 50%;
        }
        .toggle-label {
            font-size: 14px;
            color: #666;
        }
        /* Language switcher styles */
        .language-switcher {
            display: flex;
            align-items: center;
            margin-left: 15px;
        }
        .language-switcher img {
            width: 24px;
            height: 16px;
            margin: 0 5px;
            cursor: pointer;
            border: 1px solid transparent;
        }
        .language-switcher img.active {
            border-color: white;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="bi bi-airplane"></i> AeroDataBank
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#" data-page="aircraft-list" data-i18n="nav.list">Aircraft List</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-page="scatter-plot" data-i18n="nav.scatter">Comparative Charts</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-page="flight-diagram" data-i18n="nav.flight">Flight Diagram</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-page="timeline" data-i18n="nav.timeline">Historical Evolution</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-page="about" data-i18n="nav.about">About</a>
                    </li>
                </ul>
                <div class="language-switcher">
                    <img src="/images/flags/uk.png" alt="English" data-lang="en" class="active" title="English">
                    <img src="/images/flags/br.png" alt="Português" data-lang="pt" title="Português">
                </div>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- Página: Lista de Aeronaves -->
        <div class="page" id="aircraft-list">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 data-i18n="titles.list">Aircraft List</h2>
            </div>

            <div class="mb-3">
                <input type="text" class="form-control" id="aircraft-search" data-i18n-placeholder="filters.search" placeholder="Search aircraft...">
            </div>

            <div class="mb-4 category-filters">
                <h5 data-i18n="filters.title">Filter by Category</h5>
                
                <div class="row">
                    <div class="col-md-3 mb-2">
                        <label for="filter-category-type" class="form-label" data-i18n="filters.type.label">Type/Function:</label>
                        <select class="form-control form-control-sm" id="filter-category-type">
                            <option value="" data-i18n="filters.type.all">All</option>
                            <option value="comercial" data-i18n="filters.type.commercial">Commercial Aviation</option>
                            <option value="executiva" data-i18n="filters.type.executive">Business Aircraft</option>
                            <option value="carga" data-i18n="filters.type.cargo">Cargo Aviation</option>
                            <option value="militar" data-i18n="filters.type.military">Military Aviation</option>
                            <option value="geral" data-i18n="filters.type.general">General Aviation</option>
                            <option value="historica" data-i18n="filters.type.historical">Historical/Pioneer Aircraft</option>
                            <option value="experimental" data-i18n="filters.type.experimental">Experimental Aircraft</option>
                            <option value="ave" data-i18n="filters.type.bird">Birds (Biological)</option>
                        </select>
                    </div>
                    
                    <div class="col-md-3 mb-2">
                        <label for="filter-category-era" class="form-label" data-i18n="filters.era.label">Era/Generation:</label>
                        <select class="form-control form-control-sm" id="filter-category-era">
                            <option value="" data-i18n="filters.era.all">All</option>
                            <option value="pioneiros" data-i18n="filters.era.pioneers">Pioneers (until 1930)</option>
                            <option value="classica" data-i18n="filters.era.classic">Classic Era (1930-1950)</option>
                            <option value="jato_inicial" data-i18n="filters.era.early_jet">Early Jet Era (1950-1970)</option>
                            <option value="moderna" data-i18n="filters.era.modern">Modern Era (1970-2000)</option>
                            <option value="contemporanea" data-i18n="filters.era.contemporary">Contemporary Era (2000+)</option>
                            <option value="biologica" data-i18n="filters.era.biological">Biological (Birds)</option>
                        </select>
                    </div>
                    
                    <div class="col-md-3 mb-2">
                        <label for="filter-category-engine" class="form-label" data-i18n="filters.engine.label">Engine Type:</label>
                        <select class="form-control form-control-sm" id="filter-category-engine">
                            <option value="" data-i18n="filters.engine.all">All</option>
                            <option value="pistao" data-i18n="filters.engine.piston">Piston Engine</option>
                            <option value="turboelice" data-i18n="filters.engine.turboprop">Turboprop</option>
                            <option value="turbojato" data-i18n="filters.engine.turbojet">Turbojet</option>
                            <option value="turbofan" data-i18n="filters.engine.turbofan">Turbofan</option>
                            <option value="especial" data-i18n="filters.engine.special">Special Propulsion</option>
                        </select>
                    </div>
                    
                    <div class="col-md-3 mb-2">
                        <label for="filter-category-size" class="form-label" data-i18n="filters.size.label">Size:</label>
                        <select class="form-control form-control-sm" id="filter-category-size">
                            <option value="" data-i18n="filters.size.all">All</option>
                            <option value="muito_leve" data-i18n="filters.size.very_light">Very Light (up to 5,700 kg)</option>
                            <option value="regional" data-i18n="filters.size.regional">Regional (5,700-50,000 kg)</option>
                            <option value="medio" data-i18n="filters.size.medium">Medium Size (50,000-150,000 kg)</option>
                            <option value="grande" data-i18n="filters.size.large">Large Size (150,000-300,000 kg)</option>
                            <option value="muito_grande" data-i18n="filters.size.very_large">Very Large (above 300,000 kg)</option>
                        </select>
                    </div>
                </div>
                
                <div class="text-end mt-2">
                    <button class="btn btn-sm btn-secondary" id="clear-filters" data-i18n="filters.clear">Clear Filters</button>
                </div>
            </div>

            <div class="table-responsive">
                <table class="table table-striped table-hover">
                    <thead>
                        <tr>
                            <th class="sortable" data-sort="name" data-i18n="table.headers.aircraft">Aircraft</th>
                            <th class="sortable" data-sort="manufacturer" data-i18n="table.headers.manufacturer">Manufacturer</th>
                            <th class="sortable" data-sort="model" data-i18n="table.headers.model">Model</th>
                            <th class="sortable" data-sort="first_flight_year" data-i18n="table.headers.year">Year</th>
                            <th class="sortable" data-sort="category_type" data-i18n="table.headers.type">Type</th>
                            <th class="sortable" data-sort="category_era" data-i18n="table.headers.era">Era</th>
                            <th class="sortable" data-sort="mtow" data-i18n="table.headers.mtow">MTOW (kg)</th>
                        </tr>
                    </thead>
                    <tbody id="aircraft-table-body">
                        <!-- Data will be loaded via JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Página: Gráficos Comparativos -->
        <div class="page d-none" id="scatter-plot">
            <h2 data-i18n="titles.scatter">Comparative Charts</h2>
            
            <div class="row mb-4">
                <div class="col-md-4">
                    <div class="form-group">
                        <label for="x-param" data-i18n="charts.scatter.x_param">X Parameter:</label>
                        <select class="form-control" id="x-param">
                            <!-- Options will be loaded via JavaScript -->
                        </select>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="form-group">
                        <label for="y-param" data-i18n="charts.scatter.y_param">Y Parameter:</label>
                        <select class="form-control" id="y-param">
                            <!-- Options will be loaded via JavaScript -->
                        </select>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="form-group">
                        <label data-i18n="charts.scatter.scale">Chart Scale:</label>
                        <div class="d-flex">
                            <div class="form-check me-3">
                                <input class="form-check-input" type="checkbox" id="x-log-scale">
                                <label class="form-check-label" for="x-log-scale" data-i18n="charts.scatter.log_scale_x">
                                    Log Scale X
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="y-log-scale">
                                <label class="form-check-label" for="y-log-scale" data-i18n="charts.scatter.log_scale_y">
                                    Log Scale Y
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="chart-container">
                <canvas id="scatter-chart"></canvas>
            </div>
            
            <div class="mt-4" id="selected-aircraft-info">
                <h4 data-i18n="charts.scatter.selected_aircraft">Selected Aircraft</h4>
                <div id="selected-aircraft-details" data-i18n="charts.scatter.click_point">
                    Click on a point in the chart to see aircraft details.
                </div>
            </div>
        </div>

        <!-- Página: Diagrama do Voo -->
        <div id="flight-diagram" class="page d-none">
            <h2 class="mb-4" data-i18n="titles.flight">Flight Diagram</h2>
            
            <div class="row mb-4">
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="x-axis-param" data-i18n="charts.flight.select_diagram">Select Diagram:</label>
                        <select id="x-axis-param" class="form-select">
                            <option value="wing_loading_mtow" data-i18n="charts.flight.wing_loading_mtow">Wing Loading vs MTOW</option>
                            <option value="speed_mtow" data-i18n="charts.flight.speed_mtow">True Airspeed (TAS) vs MTOW</option>
                            <option value="speed_mtow_ve" data-i18n="charts.flight.speed_mtow_ve">Equivalent Speed (VE) vs MTOW</option>
                            <option value="wing_loading_speed" data-i18n="charts.flight.wing_loading_speed">Wing Loading vs True Airspeed (TAS)</option>
                            <option value="wing_loading_speed_ve" data-i18n="charts.flight.wing_loading_speed_ve">Wing Loading vs Equivalent Speed (VE)</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <label data-i18n="charts.flight.chart_options">Chart Options:</label>
                        <div class="d-flex">
                            <div class="form-check me-3">
                                <input class="form-check-input" type="checkbox" id="xLogScale" checked>
                                <label class="form-check-label" for="xLogScale" data-i18n="charts.flight.log_scale_x">
                                    Log Scale X
                                </label>
                            </div>
                            <div class="form-check me-3">
                                <input class="form-check-input" type="checkbox" id="yLogScale" checked>
                                <label class="form-check-label" for="yLogScale" data-i18n="charts.flight.log_scale_y">
                                    Log Scale Y
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="showTrendlines" checked>
                                <label class="form-check-label" for="showTrendlines" data-i18n="charts.flight.show_trendlines">
                                    Show Trendlines
                                </label>
                            </div>
                        </div>
                    </div>
                    <div id="wingLoadingMtowControls">
                        <div class="form-group">
                            <label for="mtow-coefficient">Coeficiente para W/S = k * W^(1/3):</label>
                            <div class="input-group">
                                <input type="number" id="mtow-coefficient" class="form-control" value="25" min="1" max="100" step="1">
                                <button class="btn btn-outline-secondary" type="button" id="apply-mtow-coefficient">Aplicar</button>
                            </div>
                            <small class="form-text text-muted">Ajuste o valor de k na equação W/S = k * W^(1/3)</small>
                        </div>
                    </div>
                    <div id="wingLoadingSpeedControls" style="display:none;">
                        <div class="form-group">
                            <label for="speed-coefficient">Coeficiente para W/S = k * V²:</label>
                            <div class="input-group">
                                <input type="number" id="speed-coefficient" class="form-control" value="0.38" min="0.01" max="10" step="0.01">
                                <button class="btn btn-outline-secondary" type="button" id="apply-speed-coefficient">Aplicar</button>
                            </div>
                            <small class="form-text text-muted">Ajuste o valor de k na equação W/S = k * V²</small>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="row mb-4">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0" data-i18n="charts.flight.comparative_diagram">Comparative Diagram</h5>
                        </div>
                        <div class="card-body">
                            <p class="card-text" data-i18n="charts.flight.description">
                                This diagram allows comparing different aircraft and birds based on their aerodynamic characteristics.
                                The chart uses logarithmic scale to allow visualization of aircraft of very different sizes.
                            </p>
                            <div class="chart-container" style="position: relative; height:500px;">
                                <canvas id="flight-diagram-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="row mb-4">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">Legenda</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="d-flex align-items-center mb-2">
                                        <div style="width: 20px; height: 20px; background-color: rgba(255, 99, 132, 0.7); margin-right: 10px;"></div>
                                        <span>Aves</span>
                                    </div>
                                    <div class="d-flex align-items-center mb-2">
                                        <div style="width: 20px; height: 20px; background-color: rgba(54, 162, 235, 0.7); margin-right: 10px;"></div>
                                        <span>Aviação Comercial</span>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="d-flex align-items-center mb-2">
                                        <div style="width: 20px; height: 20px; background-color: rgba(255, 206, 86, 0.7); margin-right: 10px;"></div>
                                        <span>Aviação Militar</span>
                                    </div>
                                    <div class="d-flex align-items-center mb-2">
                                        <div style="width: 20px; height: 20px; background-color: rgba(75, 192, 192, 0.7); margin-right: 10px;"></div>
                                        <span>Aviação Geral</span>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="d-flex align-items-center mb-2">
                                        <div style="width: 20px; height: 20px; background-color: rgba(153, 102, 255, 0.7); margin-right: 10px;"></div>
                                        <span>Aeronaves Históricas</span>
                                    </div>
                                    <div class="d-flex align-items-center mb-2">
                                        <div style="width: 20px; height: 20px; background-color: rgba(255, 159, 64, 0.7); margin-right: 10px;"></div>
                                        <span>Aeronaves Executivas</span>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-2">
                                <div class="col-md-12">
                                    <div class="d-flex align-items-center">
                                        <div style="width: 30px; height: 2px; background-color: rgba(200, 0, 0, 0.8); margin-right: 10px; border-top: 2px dashed rgba(200, 0, 0, 0.8);"></div>
                                        <span>Linhas de Tendência:
                                            <ul class="mb-0 mt-1">
                                                <li>No diagrama "Carga Alar x MTOW": W/S = k * W^(1/3) - ajuste o valor de k</li>
                                                <li>No diagrama "Carga Alar x Velocidade": W/S = k * V² - ajuste o valor de k</li>
                                            </ul>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Página: Evolução Histórica -->
        <div class="page d-none" id="timeline">
            <h2 data-i18n="titles.timeline">Historical Evolution</h2>
            
            <div class="row mb-4">
                <div class="col-md-8">
                    <div class="form-group">
                        <label for="timeline-param" data-i18n="charts.timeline.parameter">Parameter:</label>
                        <select class="form-control" id="timeline-param">
                            <!-- Options will be loaded via JavaScript -->
                        </select>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="form-group">
                        <label data-i18n="charts.timeline.chart_scale">Chart Scale:</label>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="timeline-log-scale">
                            <label class="form-check-label" for="timeline-log-scale" data-i18n="charts.timeline.log_scale">
                                Logarithmic Scale (Y axis)
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="chart-container">
                <canvas id="timeline-chart"></canvas>
            </div>
        </div>

        <!-- Página: Sobre -->
        <div class="page d-none" id="about">
            <h2 data-i18n="titles.about">About AeroDataBank</h2>
            
            <p data-i18n="about.intro">This database was developed to support aircraft performance courses, enabling visualization and analysis of technical characteristics of various aircraft.</p>
            
            <h4 data-i18n="about.features.title">Features</h4>
            <ul>
                <li data-i18n="about.features.items.0">Storage of aircraft technical data (MTOW, wing area, wingspan, speeds, etc.)</li>
                <li data-i18n="about.features.items.1">Automatic calculation of performance parameters (lift coefficient, wing loading, etc.)</li>
                <li data-i18n="about.features.items.2">Web interface for viewing, adding, removing, and modifying aircraft</li>
                <li data-i18n="about.features.items.3">Comparative charts between different aircraft</li>
                <li data-i18n="about.features.items.4">Historical evolution visualization of performance characteristics</li>
            </ul>
            
            <h4 data-i18n="about.scales.title">Chart Scales</h4>
            <p data-i18n="about.scales.intro">The system allows data visualization in linear or logarithmic scales:</p>
            <ul>
                <li><strong>Linear Scale:</strong> <span data-i18n="about.scales.linear">Shows values in a uniform progression. Useful for comparing absolute differences between aircraft.</span></li>
                <li><strong>Logarithmic Scale:</strong> <span data-i18n="about.scales.log">Shows values in a progression where each increment represents multiplication by a constant factor. Useful for viewing data that varies by several orders of magnitude, such as comparing the MTOW of the Wright Flyer (338 kg) with that of the Airbus A380 (575,000 kg).</span></li>
            </ul>
            <p data-i18n="about.scales.when_to_use.title">When to use each scale:</p>
            <ul>
                <li><strong>Linear-Linear:</strong> <span data-i18n="about.scales.when_to_use.lin_lin">For comparing similar aircraft or when absolute differences are important.</span></li>
                <li><strong>Log-Linear or Linear-Log:</strong> <span data-i18n="about.scales.when_to_use.log_lin">When one parameter varies by very different orders of magnitude.</span></li>
                <li><strong>Log-Log:</strong> <span data-i18n="about.scales.when_to_use.log_log">To identify power relationships between parameters (e.g., weight-power relationship) or when both parameters vary by very different orders of magnitude.</span></li>
            </ul>
            
            <h4 data-i18n="about.data_sources.title">Data Sources</h4>
            <p data-i18n="about.data_sources.intro">Aircraft data can be obtained from various sources, including:</p>
            <ul>
                <li><a href="https://contentzone.eurocontrol.int/aircraftperformance/default.aspx" target="_blank" data-i18n="about.data_sources.sources.0">EUROCONTROL Aircraft Performance Database</a></li>
                <li data-i18n="about.data_sources.sources.1">Manufacturer manuals</li>
                <li data-i18n="about.data_sources.sources.2">Aviation industry technical publications</li>
            </ul>
        </div>
    </div>

    <!-- Modal para adicionar/editar aeronave -->
    <div class="modal fade" id="aircraft-modal" tabindex="-1" aria-labelledby="aircraft-modal-title" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="aircraft-modal-title">Adicionar Aeronave</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="aircraft-form">
                        <input type="hidden" id="aircraft-id">
                        
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label for="name" class="form-label">Nome</label>
                                <input type="text" class="form-control" id="name" required>
                            </div>
                            <div class="col-md-4">
                                <label for="manufacturer" class="form-label">Fabricante</label>
                                <input type="text" class="form-control" id="manufacturer" required>
                            </div>
                            <div class="col-md-4">
                                <label for="model" class="form-label">Modelo</label>
                                <input type="text" class="form-control" id="model" required>
                            </div>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label for="first_flight_year" class="form-label">Ano do Primeiro Voo</label>
                                <input type="number" class="form-control" id="first_flight_year">
                            </div>
                            <div class="col-md-4">
                                <label for="engine_type" class="form-label">Tipo de Motor</label>
                                <input type="text" class="form-control" id="engine_type">
                            </div>
                            <div class="col-md-4">
                                <label for="engine_count" class="form-label">Número de Motores</label>
                                <input type="number" class="form-control" id="engine_count">
                            </div>
                        </div>
                        
                        <h5 class="mt-4">Categorias</h5>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="category_type" class="form-label">Tipo/Função</label>
                                <select class="form-control" id="category_type">
                                    <option value="">Selecione...</option>
                                    <option value="comercial">Aviação Comercial</option>
                                    <option value="executiva">Aeronaves Executivas</option>
                                    <option value="carga">Aviação de Carga</option>
                                    <option value="militar">Aviação Militar</option>
                                    <option value="geral">Aviação Geral</option>
                                    <option value="historica">Aeronaves Históricas/Pioneiras</option>
                                    <option value="experimental">Aeronaves Experimentais</option>
                                    <option value="ave">Aves (Biológico)</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="category_era" class="form-label">Era/Geração</label>
                                <select class="form-control" id="category_era">
                                    <option value="">Selecione...</option>
                                    <option value="pioneiros">Pioneiros (até 1930)</option>
                                    <option value="classica">Era Clássica (1930-1950)</option>
                                    <option value="jato_inicial">Era do Jato Inicial (1950-1970)</option>
                                    <option value="moderna">Era Moderna (1970-2000)</option>
                                    <option value="contemporanea">Era Contemporânea (2000-presente)</option>
                                    <option value="biologica">Biológico</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="category_engine" class="form-label">Motorização</label>
                                <select class="form-control" id="category_engine">
                                    <option value="">Selecione...</option>
                                    <option value="pistao">Motor a Pistão</option>
                                    <option value="turboelice">Turboélice</option>
                                    <option value="turbojato">Turbojato</option>
                                    <option value="turbofan">Turbofan</option>
                                    <option value="especial">Propulsão Especial</option>
                                    <option value="muscular">Muscular (Biológico)</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="category_size" class="form-label">Tamanho</label>
                                <select class="form-control" id="category_size">
                                    <option value="">Selecione...</option>
                                    <option value="muito_leve">Muito Leve (até 5.700 kg)</option>
                                    <option value="regional">Regional (5.700-50.000 kg)</option>
                                    <option value="medio">Médio Porte (50.000-150.000 kg)</option>
                                    <option value="grande">Grande Porte (150.000-300.000 kg)</option>
                                    <option value="muito_grande">Muito Grande (acima de 300.000 kg)</option>
                                </select>
                            </div>
                        </div>
                        
                        <h5 class="mt-4">Características Físicas</h5>
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label for="mtow" class="form-label">MTOW (kg)</label>
                                <input type="number" step="0.01" class="form-control" id="mtow">
                            </div>
                            <div class="col-md-4">
                                <label for="wing_area" class="form-label">Área da Asa (m²)</label>
                                <input type="number" step="0.01" class="form-control" id="wing_area">
                            </div>
                            <div class="col-md-4">
                                <label for="wingspan" class="form-label">Envergadura (m)</label>
                                <input type="number" step="0.01" class="form-control" id="wingspan">
                            </div>
                        </div>
                        
                        <h5 class="mt-4">Velocidades</h5>
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label for="cruise_speed" class="form-label">Velocidade de Cruzeiro (km/h)</label>
                                <input type="number" step="0.01" class="form-control" id="cruise_speed">
                            </div>
                            <div class="col-md-4">
                                <label for="takeoff_speed" class="form-label">Velocidade de Decolagem (km/h)</label>
                                <input type="number" step="0.01" class="form-control" id="takeoff_speed">
                            </div>
                            <div class="col-md-4">
                                <label for="landing_speed" class="form-label">Velocidade de Pouso (km/h)</label>
                                <input type="number" step="0.01" class="form-control" id="landing_speed">
                            </div>
                        </div>
                        
                        <h5 class="mt-4">Outras Características</h5>
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label for="service_ceiling" class="form-label">Teto de Serviço (m)</label>
                                <input type="number" step="0.01" class="form-control" id="service_ceiling">
                            </div>
                            <div class="col-md-4">
                                <label for="cruise_altitude" class="form-label">Altitude de Cruzeiro (m)</label>
                                <input type="number" step="0.01" class="form-control" id="cruise_altitude">
                            </div>
                            <div class="col-md-4">
                                <label for="max_thrust" class="form-label">Tração Máxima (kN)</label>
                                <input type="number" step="0.01" class="form-control" id="max_thrust">
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="image_url" class="form-label">URL da Imagem</label>
                            <input type="url" class="form-control" id="image_url">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="save-aircraft">Salvar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para visualizar detalhes da aeronave -->
    <div class="modal fade" id="aircraft-details-modal" tabindex="-1" aria-labelledby="aircraft-details-title" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="aircraft-details-title">Detalhes da Aeronave</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="aircraft-details-body">
                    <!-- Conteúdo será preenchido via JavaScript -->
                    <div class="text-center py-5">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Carregando...</span>
                        </div>
                        <p class="mt-2">Carregando detalhes da aeronave...</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/i18n.js"></script>
    <script src="/app.js"></script>
    
    <!-- Script para implementar a ordenação da tabela e outras funcionalidades -->
    <script>
        // Adicionar evento de ordenação após o carregamento da página
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Adicionando funcionalidade de ordenação à tabela...');
            
            // Função para ordenar a tabela
            function sortTable(column) {
                console.log('Ordenando tabela pela coluna:', column);
                
                const table = document.querySelector('table');
                const tbody = table.querySelector('tbody');
                const rows = Array.from(tbody.querySelectorAll('tr'));
                const headers = table.querySelectorAll('th.sortable');
                
                // Determinar direção da ordenação
                let isAscending = true;
                headers.forEach(header => {
                    if (header.getAttribute('data-sort') === column) {
                        if (header.classList.contains('asc')) {
                            isAscending = false;
                            header.classList.remove('asc');
                            header.classList.add('desc');
                        } else {
                            isAscending = true;
                            header.classList.remove('desc');
                            header.classList.add('asc');
                        }
                    } else {
                        header.classList.remove('asc', 'desc');
                    }
                });
                
                // Obter índice da coluna
                let columnIndex = 0;
                const headerArray = Array.from(headers);
                headerArray.forEach((header, index) => {
                    if (header.getAttribute('data-sort') === column) {
                        columnIndex = index;
                    }
                });
                
                // Ignorar linha de "nenhum resultado"
                const filteredRows = rows.filter(row => row.id !== 'no-filter-results');
                
                // Ordenar as linhas
                filteredRows.sort((rowA, rowB) => {
                    const cellA = rowA.querySelectorAll('td')[columnIndex];
                    const cellB = rowB.querySelectorAll('td')[columnIndex];
                    
                    // Se não encontrar as células, não ordenar
                    if (!cellA || !cellB) return 0;
                    
                    let valueA = cellA.textContent.trim();
                    let valueB = cellB.textContent.trim();
                    
                    // Converter para número se necessário
                    if (['mtow', 'cruise_speed', 'first_flight_year'].includes(column)) {
                        // Remove qualquer formatação de número (como vírgulas)
                        valueA = valueA.replace(/[^\d.-]/g, '');
                        valueB = valueB.replace(/[^\d.-]/g, '');
                        
                        valueA = valueA === '-' ? 0 : Number(valueA);
                        valueB = valueB === '-' ? 0 : Number(valueB);
                    }
                    
                    // Comparar valores
                    if (valueA < valueB) return isAscending ? -1 : 1;
                    if (valueA > valueB) return isAscending ? 1 : -1;
                    return 0;
                });
                
                // Reordenar as linhas na tabela
                while (tbody.firstChild) {
                    tbody.removeChild(tbody.firstChild);
                }
                
                filteredRows.forEach(row => {
                    tbody.appendChild(row);
                });
                
                // Mostrar alertas utilizando a função existente, se disponível
                if (typeof window.showAlert === 'function') {
                    window.showAlert(`Tabela ordenada por ${column} em ordem ${isAscending ? 'crescente' : 'decrescente'}`, 'info');
                }
            }
            
            // Adicionar evento de clique aos cabeçalhos
            const headers = document.querySelectorAll('th.sortable');
            headers.forEach(header => {
                header.addEventListener('click', function() {
                    const column = this.getAttribute('data-sort');
                    console.log('Cabeçalho clicado:', column);
                    sortTable(column);
                });
            });
            
            // Tornar a função sortTable global
            window.sortTable = sortTable;
            
            console.log('Funcionalidade de ordenação adicionada com sucesso!');
        });
        
        // Funcionalidade de filtragem por categoria (global)
        window.applyFilters = function() {
            console.log('Aplicando filtros...');
            
            const filterType = document.getElementById('filter-category-type')?.value || '';
            const filterEra = document.getElementById('filter-category-era')?.value || '';
            const filterEngine = document.getElementById('filter-category-engine')?.value || '';
            const filterSize = document.getElementById('filter-category-size')?.value || '';
            const searchText = (document.getElementById('aircraft-search')?.value || '').toLowerCase();
            
            console.log('Filtros selecionados:', {
                tipo: filterType,
                era: filterEra,
                motor: filterEngine,
                tamanho: filterSize,
                texto: searchText
            });
            
            const rows = document.querySelectorAll('tbody tr');
            if (!rows.length) {
                console.log('Nenhuma linha encontrada para filtrar');
                return;
            }
            
            let visibleCount = 0;
            
            rows.forEach(row => {
                try {
                    // Ignorar linhas de mensagem (como "Nenhum resultado")
                    if (row.id === 'no-filter-results') return;
                    
                    const nameCell = row.querySelector('td:nth-child(1)');
                    const manufacturerCell = row.querySelector('td:nth-child(2)');
                    const modelCell = row.querySelector('td:nth-child(3)');
                    
                    if (!nameCell || !manufacturerCell || !modelCell) {
                        console.warn('Células necessárias não encontradas na linha');
                        return;
                    }
                    
                    // Obter texto para busca
                    const textToSearch = [
                        nameCell.textContent.toLowerCase(),
                        manufacturerCell.textContent.toLowerCase(),
                        modelCell.textContent.toLowerCase()
                    ].join(' ');
                    
                    // Obter valores dos atributos de categoria
                    const categoryType = row.getAttribute('data-category-type') || '';
                    const categoryEra = row.getAttribute('data-category-era') || '';
                    const categoryEngine = row.getAttribute('data-category-engine') || '';
                    const categorySize = row.getAttribute('data-category-size') || '';
                    
                    // Verificar se os filtros correspondem
                    const typeMatch = !filterType || categoryType === filterType;
                    const eraMatch = !filterEra || categoryEra === filterEra;
                    const engineMatch = !filterEngine || categoryEngine === filterEngine;
                    const sizeMatch = !filterSize || categorySize === filterSize;
                    const textMatch = !searchText || textToSearch.includes(searchText);
                    
                    // Se todos os filtros correspondem, mostrar a linha
                    if (typeMatch && eraMatch && engineMatch && sizeMatch && textMatch) {
                        row.style.display = '';
                        visibleCount++;
                    } else {
                        row.style.display = 'none';
                    }
                } catch (e) {
                    console.error('Erro ao filtrar linha:', e);
                }
            });
            
            console.log(`Filtros aplicados: ${visibleCount} aeronaves visíveis`);
            
            // Mostrar mensagem se não houver resultados
            const noResultsEl = document.getElementById('no-filter-results');
            
            if (visibleCount === 0) {
                if (!noResultsEl) {
                    const tbody = document.querySelector('tbody');
                    if (tbody) {
                        const noResults = document.createElement('tr');
                        noResults.id = 'no-filter-results';
                        noResults.innerHTML = '<td colspan="8" class="text-center py-3">Nenhuma aeronave encontrada com os filtros selecionados.</td>';
                        tbody.appendChild(noResults);
                    }
                }
            } else if (noResultsEl) {
                noResultsEl.remove();
            }
        };
        
        // Configurar eventos para os filtros
        document.addEventListener('DOMContentLoaded', function() {
            const filterType = document.getElementById('filter-category-type');
            const filterEra = document.getElementById('filter-category-era');
            const filterEngine = document.getElementById('filter-category-engine');
            const filterSize = document.getElementById('filter-category-size');
            const searchInput = document.getElementById('aircraft-search');
            const clearFiltersBtn = document.getElementById('clear-filters');
            
            if (filterType) filterType.addEventListener('change', window.applyFilters);
            if (filterEra) filterEra.addEventListener('change', window.applyFilters);
            if (filterEngine) filterEngine.addEventListener('change', window.applyFilters);
            if (filterSize) filterSize.addEventListener('change', window.applyFilters);
            if (searchInput) searchInput.addEventListener('input', window.applyFilters);
            
            if (clearFiltersBtn) {
                clearFiltersBtn.addEventListener('click', function() {
                    if (filterType) filterType.value = '';
                    if (filterEra) filterEra.value = '';
                    if (filterEngine) filterEngine.value = '';
                    if (filterSize) filterSize.value = '';
                    if (searchInput) searchInput.value = '';
                    window.applyFilters();
                });
            }
            
            console.log('Event listeners de filtro configurados');
        });
    </script>

    <!-- Função para visualizar detalhes da aeronave -->
    <script>
        // Função removida - agora usando a implementação do app.js
        
        // Função para configurar tooltips de imagens
        window.setupImageTooltip = function(element, aircraft) {
            if (!element || !aircraft || !aircraft.image_url) return;
            
            // Criar elementos da tooltip
            const tooltip = document.createElement('div');
            tooltip.className = 'aircraft-tooltip';
            tooltip.style.position = 'absolute';
            tooltip.style.zIndex = '1000';
            tooltip.style.display = 'none';
            tooltip.style.backgroundColor = 'white';
            tooltip.style.border = '1px solid #ccc';
            tooltip.style.borderRadius = '4px';
            tooltip.style.boxShadow = '0 2px 5px rgba(0,0,0,0.2)';
            tooltip.style.overflow = 'hidden';
            tooltip.style.width = '200px';
            
            // Adicionar imagem
            const img = document.createElement('img');
            img.src = aircraft.image_url;
            img.alt = aircraft.name;
            img.style.width = '100%';
            img.style.height = '120px';
            img.style.objectFit = 'cover';
            
            // Adicionar legenda
            const caption = document.createElement('div');
            caption.textContent = aircraft.name;
            caption.style.padding = '5px';
            caption.style.backgroundColor = 'rgba(0,0,0,0.7)';
            caption.style.color = 'white';
            caption.style.fontSize = '12px';
            caption.style.textAlign = 'center';
            
            tooltip.appendChild(img);
            tooltip.appendChild(caption);
            document.body.appendChild(tooltip);
            
            // Mostrar tooltip ao passar o mouse
            element.addEventListener('mouseenter', function(e) {
                const rect = element.getBoundingClientRect();
                tooltip.style.left = rect.left + 'px';
                tooltip.style.top = (rect.bottom + window.scrollY + 5) + 'px';
                tooltip.style.display = 'block';
            });
            
            // Esconder tooltip ao remover o mouse
            element.addEventListener('mouseleave', function() {
                tooltip.style.display = 'none';
            });
        }

        // Função para mostrar alertas
        window.showAlert = function(message, type = 'info') {
            // Criar elemento de alerta
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
            alertDiv.setAttribute('role', 'alert');
            alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            `;
            
            // Adicionar ao DOM
            const container = document.querySelector('.container');
            container.insertBefore(alertDiv, container.firstChild);
            
            // Remover após 5 segundos
            setTimeout(() => {
                alertDiv.classList.remove('show');
                setTimeout(() => alertDiv.remove(), 150);
            }, 5000);
        }
    </script>

    <!-- Função para renderizar a tabela -->
    <script>
        // Função para renderizar a tabela de aeronaves
        window.renderAircraftTable = function(data) {
            // Verificar se os dados são válidos
            if (!data) {
                console.error('Dados de aeronaves indefinidos ou nulos');
                const tbody = document.getElementById('aircraft-table-body');
                if (tbody) {
                    tbody.innerHTML = '<tr><td colspan="8" class="text-center">Nenhum dado disponível. Tente importar aeronaves usando o botão "Importar Exemplos".</td></tr>';
                }
                return;
            }
            
            // Verificar se temos aves nos dados
            const birds = data.filter(item => item.category_type === 'ave');
            console.log(`Renderizando tabela com ${data.length} itens, incluindo ${birds.length} aves`);
            
            const tbody = document.getElementById('aircraft-table-body');
            if (!tbody) {
                console.error('Elemento tbody não encontrado');
                return;
            }
            
            // Limpar a tabela antes de renderizar
            tbody.innerHTML = '';
            
            // Mapear valores de categoria para texto legível
            const categoryTypeMap = {
                'comercial': 'Aviação Comercial',
                'executiva': 'Aeronaves Executivas',
                'carga': 'Aviação de Carga',
                'militar': 'Aviação Militar',
                'geral': 'Aviação Geral',
                'historica': 'Aeronaves Históricas',
                'experimental': 'Aeronaves Experimentais',
                'ave': 'Ave'
            };
            
            const categoryEraMap = {
                'pioneiros': 'Pioneiros (até 1930)',
                'classica': 'Era Clássica (1930-1950)',
                'jato_inicial': 'Era do Jato (1950-1970)',
                'moderna': 'Era Moderna (1970-2000)',
                'contemporanea': 'Era Contemporânea (2000+)',
                'biologica': 'Biológico'
            };
            
            // Criar todas as linhas de uma vez (sem async/await)
            const fragment = document.createDocumentFragment();
            
            // Processar cada aeronave
            data.forEach(aircraft => {
                if (!aircraft) return;  // Pular entradas nulas
                
                // Log para debug de aves
                if (aircraft.category_type === 'ave') {
                    console.log('Renderizando ave:', aircraft.name);
                }
                
                const row = document.createElement('tr');
                
                // Adicionar categorias como atributos de dados para filtragem
                if (aircraft.category_type) {
                    row.setAttribute('data-category-type', aircraft.category_type);
                }
                if (aircraft.category_era) row.setAttribute('data-category-era', aircraft.category_era);
                if (aircraft.category_engine) row.setAttribute('data-category-engine', aircraft.category_engine);
                if (aircraft.category_size) row.setAttribute('data-category-size', aircraft.category_size);
                
                // Usar a URL da imagem diretamente (sem validação assíncrona)
                let imageUrl = aircraft.image_url;
                if (typeof getValidImageUrl === 'function') {
                    try {
                        // Versão síncrona da validação
                        const category = aircraft.category_type || 'geral';
                        imageUrl = imageUrl || `/images/fallback/${category}.jpg`;
                    } catch (error) {
                        console.error(`Error with image for ${aircraft.name}:`, error);
                        imageUrl = `/images/fallback/${aircraft.category_type || 'geral'}.jpg`;
                    }
                }
                
                // Criar o HTML da célula do nome com tooltip simplificado
                const nameCell = `
                    <a href="#" 
                       onclick="viewAircraftDetails(${aircraft.id}); return false;" 
                       class="aircraft-name"
                       data-bs-toggle="tooltip" 
                       data-bs-placement="right" 
                       title="${aircraft.name}"
                    >
                        ${aircraft.name || 'Sem nome'}
                    </a>
                `;
                
                row.innerHTML = `
                    <td>${nameCell}</td>
                    <td>${aircraft.manufacturer || '-'}</td>
                    <td>${aircraft.model || '-'}</td>
                    <td>${aircraft.first_flight_year || '-'}</td>
                    <td>${categoryTypeMap[aircraft.category_type] || '-'}</td>
                    <td>${categoryEraMap[aircraft.category_era] || '-'}</td>
                    <td>${aircraft.mtow_N ? (aircraft.mtow_N).toLocaleString() : '-'}</td>
                `;
                
                fragment.appendChild(row);
            });
            
            // Adicionar todas as linhas de uma vez
            tbody.appendChild(fragment);
            
            // Inicializar tooltips do Bootstrap
            if (typeof bootstrap !== 'undefined' && bootstrap.Tooltip) {
                const tooltips = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
                tooltips.map(function (tooltipTriggerEl) {
                    return new bootstrap.Tooltip(tooltipTriggerEl);
                });
            }
            
            // Aplicar filtros se existirem
            if (window.applyFilters && typeof window.applyFilters === 'function') {
                window.applyFilters();
            }
        }
    </script>

    <!-- Função para editar e remover aeronaves -->
    <script>
        // Função global para importar dados de aves - REMOVIDA
        // As aves agora são carregadas automaticamente junto com as aeronaves
        
        // Configurar evento para o botão de importação - REMOVIDO
        // O botão de importação de aves não é mais necessário
    </script>
</body>
</html> 